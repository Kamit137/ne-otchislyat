<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="/src/css/profile.css">


<body>
    <div class="section">
        <div class="section-conatiner__list">
            <div class="container-logo">
                <h4>ne-otchislyat.ru</h4>
            </div>
            <div class="container-list">
                <div class="header-list">
                    <span>На главную</span>
                    <hr>
                </div>
                <div class="header-list">
                    <span>Выход</span>
                    <hr>
                </div>
            </div>
        </div>
        <div class="section-container__user">
            <div class="container-user__profile block-profile">
                <h1>Профиль</h1>

                <div class="form-profile">
                    <label for="">Имя:</label>
                    <div class="div__form-profile">
                        <div class="form-profile__text">
                            <input type="text">
                            <hr>
                        </div>
                        <img src="img/edit_24dp_FFFFFF_FILL0_wght400_GRAD0_opsz24 (1).svg" alt="">
                    </div>
                </div>
                <div class="form-profile">
                    <label for="">Почта:</label>
                    <div class="div__form-profile">
                        <div class="form-profile__text">
                            <input type="text">
                            <hr>
                        </div>
                        <img src="img/edit_24dp_FFFFFF_FILL0_wght400_GRAD0_opsz24 (1).svg" alt="">
                    </div>
                </div>
                <div class="form-profile">
                    <label for="">
                        Телеграмм:
                    </label>
                    <div class="div__form-profile">
                        <div class="form-profile__text">
                            <input type="text">
                            <hr>
                        </div>
                        <img src="img/edit_24dp_FFFFFF_FILL0_wght400_GRAD0_opsz24 (1).svg" alt="">
                    </div>
                </div>
                <div class="user-profile__block-tegs">
                    <div class="container__block-tegs">
                        <span class="text-teg">Лабораторные</span>
                        <div class="lab block-tegs">
                            <button>wgwgw</button>
                            <button>wfwfw</button>
                            <button>wfwwef</button>
                            <button>wgge</button>
                            <button>ergerg</button>
                            <button>egegr</button>
                        </div>
                    </div>
                    <div class="container__block-tegs">
                        <span class="text-teg">Семинары</span>
                        <div class="sem block-tegs">
                            <button>wgwgw</button>
                            <button>wfwfw</button>
                            <button>wfwwef</button>
                            <button>wgge</button>
                            <button>ergerg</button>
                            <button>egegr</button>
                        </div>
                    </div>
                    <div class="container__block-tegs">
                        <span class="text-teg">Домашняя работа</span>
                        <div class="home-work block-tegs">
                            <button>wgwgw</button>
                            <button>wfwfw</button>
                            <button>wfwwef</button>
                            <button>wgge</button>
                            <button>ergerg</button>
                            <button>egegr</button>
                        </div>
                    </div>
                    <div class="container__block-tegs">
                        <span class="text-teg">Курсовая</span>
                        <div class="grand-work block-tegs">
                            <button>wgwgw</button>
                            <button>wfwfw</button>
                            <button>wfwwef</button>
                            <button>wgge</button>
                            <button>ergerg</button>
                            <button>egegr</button>
                        </div>
                    </div>
                    <div class="container__block-tegs">
                        <span class="text-teg">Ментерство</span>
                        <div class="helper block-tegs">
                            <button>wgwgw</button>
                            <button>wfwfw</button>
                            <button>wfwwef</button>
                            <button>wgge</button>
                            <button>ergerg</button>
                            <button>egegr</button>
                        </div>
                    </div>
                </div>
                <div>

                </div>
                <form class="form-newtask" action="">
                    <div class="text1">
                        <label class="color" for="TableName">TableName:</label>
                        <input class="colorbox" id="TableName" name="login" type="text">
                    </div>
                    <div class="text1">
                        <label class="color" for="title">title:</label>
                        <input class="colorbox" id="title" name="login" type="text">
                    </div>
                    <div class="text1">
                        <label class="color" for="discription">discription:</label>
                        <input class="colorbox" id="discription" name="login" type="text">
                    </div>
                    <div class="text1">
                        <label class="color" for="price">price:</label>
                        <input class="colorbox" id="price" name="login" type="text">
                    </div>
                    <div class="text1">
                        <label class="color" for="tegs">tegs:</label>
                        <div class="choice-tegs">
                            <label class="label-tegs" for="mat">математика</label>
                            <input class="colorbox" id="mat" name="login" type="checkbox">
                        </div>
                        <div class="choice-tegs">
                            <label class="label-tegs" for="ter">термех</label>
                            <input class="colorbox" id="ter" name="login" type="checkbox">
                        </div>
                        <div class="choice-tegs">
                            <label class="label-tegs" for="angl">английский</label>
                            <input class="colorbox" id="angl" name="login" type="checkbox">
                        </div>
                        <div class="choice-tegs">
                            <label class="label-tegs" for="rus">русский</label>
                            <input class="colorbox" id="rus" name="login" type="checkbox">
                        </div>
                    </div>
                    <button type="submit" class="new-task">Добавить задачу</button>
                </form>

            </div>
            <div class="container__cases-comment">
                <div class="cases block__comment-cases">
                    <div class="block-text1">
                        <h2 class="text-cases">Заказы</h2>
                    </div>
                </div>
                <div class="comment block__comment-cases">
                    <div class="block-text1">
                        <h3 class="text-comment">Вакансии</h3>
                    </div>
                </div>
            </div>
        </div>
        <div>rgegrger</div>

    </div>
    <script>
        const formNewtask = document.querySelector('.form-newtask');
        formNewtask.addEventListener('submit', (event) => {
            event.preventDefault();

            const TableName = document.querySelector('#TableName').value;
            const title = document.querySelector('#title').value;
            const discription = document.querySelector('#discription').value;
            const price = document.querySelector('#price').value;


            const taskItems = document.querySelectorAll('.choice-tegs');
            const selectedTags = [];

            taskItems.forEach((item) => {
                const checkbox = item.querySelector('input[type="checkbox"]');
                const label = item.querySelector('label');

                if (checkbox && checkbox.checked) {
                    selectedTags.push(label.textContent);
                }
            });
            
            const taskData = {
                tableName: TableName,
                title: title,
                discription: discription,
                price: parseInt(document.querySelector('#price').value) || 0,
                tags: selectedTags
            };
            
            fetch('http://localhost:8080/api/addCard', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(taskData)
            })
                .then(response => {
                    if (!response.ok) {
                        return response.text().then(text => {
                            throw new Error(text)
                        });
                    }
                    return response.json();
                })
                .then(data => {
                    console.log('Успех:', data);

                    formNewtask.reset();
                })
                .catch(error => {
                    console.error('Ошибка:', error);
                });
        });
    </script>
    <script>
    // Загрузка данных профиля при открытии страницы
    fetch('/api/profile', {
        method: 'GET',
        headers: {
            'Content-Type': 'application/json'
        }
    })
    .then(response => {
        if (!response.ok) {
            throw new Error('Ошибка загрузки профиля');
        }
        return response.json();
    })
    .then(data => {
        // Заполняем поля
        const inputs = document.querySelectorAll('.form-profile input[type="text"]');
        if (inputs.length >= 3) {
            inputs[0].value = data.name || '';           // Имя
            inputs[1].value = data.email || '';          // Почта
            inputs[2].value = data.tgUs || '';           // Телеграм
        }

        // Здесь можно добавить заполнение тегов, заказов и т.д.
        console.log('Профиль загружен:', data);
    })
    .catch(err => {
        console.error('Ошибка:', err);
    });
</script>
</body>

</html>